---
title: 又一款内网穿透工具————inlets
tags:
  - Tools
date: 2019-08-27 23:01:48
---

## 前言

---

随着IPV4地址的不断匮乏，现在很多电信运营商早就开始将用户的上网IP私网化，即我们常说的内网地址，这样的地址是经过NAT的，很多用户通过运营商提供的内网地址共享一个公网地址进行上网，运营商的IP资源节省了，普通用户也感觉不出什么区别，但对于需要外部访问家中或者公司中一些资源的用户来说，这就是灾难，也许有人说你可以打电话投诉来获取公网IP，电信联通可能还行得通，对于大内网的移动就无法实现了，为了解决访问内部资源的这个问题，内网穿透工具应运而生，内网穿透工具也如雨后春笋一般扎堆出现了

Ngrok，Frp，Serveo乃至已经商业化很成功的花生壳，这类工具虽然已经很成熟了，但这并不是本篇分享的重点。通过github的推荐，我发现了一个有趣的内网穿透工具——[inlets](https://github.com/alexellis/inlets)

<!-- more -->

## 为啥推荐它

---

有时候第一眼的感觉很重要，它就是那个吸引我的工具，虽然我现在的主力是Frp，但我真的觉得inlets值得一试

inlets 结合了反向代理和 websocket 隧道，通过出口节点将内部和开发端点暴露给公网。出口节点可以是 VPS 或具有 IPv4 IP 地址的任何其他计算机，与SSL结合使用时inlets可以与任何支持CONNECT的内网HTTP代理一起使用

## 它能做啥

---

> 开发者[Alex Ellis](https://github.com/alexellis)更新还是很频繁的，由1.x升级到2.x之后，作者直接声称其完全可以胜任生产环境，只不过在部署之前建议先测试一下

* 基础功能：

1.根据客户端设置在远程服务器上创建端口
2.基于域名进行端口复用
3.利用**SSL over websocket**进行安全的加密通信
4.断线重连
5.支持身份认证
6.多平台支持
7.与Docker和Kubernetes集成

* 计划功能支持：

1.自动配置DNS/A记录
2.隧道websocket流量以及HTTP(S)
3.发现并配置Kubernetes Ingress定义的端点
...

虽然此时可以穿透的协议还只局限于HTTP或者HTTPS?，但作者还是愿意在今后的更新中添加对纯TCP流量的支持；未来肯定会越来越美好，有能力的小伙伴不妨也为其提供自己的一份力量

## 运行原理

---

### 原理图

{% asset_img 01.png inlets 01 %}

### 流程说明

* 假设将服务器的域名设定为"www.site.com"，此时inlets作为服务端监听在服务器的80端口，根据客户发起的协议匹配不同规则
* 而客户端使用websocket协议对服务端发起通讯，通讯可以使用加密或者不加密两种模式进行，这完全取决于服务端是否使用SSL加密
* 客户端和服务器通过共享密钥进行身份认证，认证通过即建立起了连接
* 此时，客户端设定的内网地址和端口就和服务端建立起了一条隧道
* 隧道建立后，服务端的80端口就相当于映射了客户端本地的127.0.0.1:3000
* 当用户访问"www.site.com"这个网址时，就相当于访问内网中的3000端口

## 实例

---

> 光讲原理说明的好像也没啥意义，那就用个人的一个实例来说明吧！

### 实例说明

vps域名

## 历史

---

* **2019.08.27** 建立初稿
