<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"ksana410.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="前言 现在就开始建立自己的Linux路由吧，我将会根据情况将这一过程划分成及部分进行说明，每个部分实现一个或多个主要功能，并给出一些个人建议，此教程并不适合所有人，但我希望能给大家启发。">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux路由补完计划02 Debian安装及配置基础路由功能">
<meta property="og:url" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/index.html">
<meta property="og:site_name" content="Vincent折腾笔记">
<meta property="og:description" content="前言 现在就开始建立自己的Linux路由吧，我将会根据情况将这一过程划分成及部分进行说明，每个部分实现一个或多个主要功能，并给出一些个人建议，此教程并不适合所有人，但我希望能给大家启发。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/01.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/02.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/03.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/04.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/05.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/06.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/07.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/08.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/09.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/10.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/11.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/12.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/13.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/14.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/15.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/16.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/17.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/18.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/19.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/20.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/21.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/22.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/25.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/26.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/27.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/28.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/29.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/30.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/31.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/32.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/34.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/36.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/37.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/38.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/39.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/40.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/55.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/42.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/43.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/46.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/47.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/48.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/49.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/50.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/51.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/52.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/53.png">
<meta property="og:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/54.png">
<meta property="article:published_time" content="2019-07-20T22:16:56.000Z">
<meta property="article:modified_time" content="2022-03-20T17:39:27.225Z">
<meta property="article:author" content="ksana410">
<meta property="article:tag" content="Linux">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/01.png">

<link rel="canonical" href="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Linux路由补完计划02 Debian安装及配置基础路由功能 | Vincent折腾笔记</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Vincent折腾笔记</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Vincent折腾笔记</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ksana410.github.io/2019/07/20/linux-router-02-install-debian-and-configure-forward/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="ksana410">
      <meta itemprop="description" content="热爱瞎折腾的理工男">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vincent折腾笔记">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Linux路由补完计划02 Debian安装及配置基础路由功能
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2019-07-20 22:16:56" itemprop="dateCreated datePublished" datetime="2019-07-20T22:16:56+00:00">2019-07-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-03-20 17:39:27" itemprop="dateModified" datetime="2022-03-20T17:39:27+00:00">2022-03-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><hr>
<p>现在就开始建立自己的Linux路由吧，我将会根据情况将这一过程划分成及部分进行说明，每个部分实现一个或多个主要功能，并给出一些个人建议，此教程并不适合所有人，但我希望能给大家启发。</p>
<span id="more"></span>

<h2 id="视频说明"><a href="#视频说明" class="headerlink" title="视频说明"></a>视频说明</h2><hr>
<iframe width="560" height="315" src="https://www.youtube.com/embed/6AH0ccrt02o" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<p>补上遗漏的防火墙固化部分：</p>
<iframe width="560" height="315" src="https://www.youtube.com/embed/bRMD029150U" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<h2 id="功能说明"><a href="#功能说明" class="headerlink" title="功能说明"></a>功能说明</h2><hr>
<p>本教程将以Debian为基础，在ESXI提供的虚拟平台上实现一个带有翻墙功能的路由系统，由于自己是一个懒癌晚期患者，故暂时不会提供一键脚本来实现此功能。我希望通过我一步步的操作，让大家对整个Linux路由有比较完整的认识，本期将演示下述内容：</p>
<ul>
<li>虚拟机建立，及配置说明；</li>
<li>Debian安装注意点；</li>
<li>网卡配置，内外网划分；</li>
<li>开启转发，实现基础路由功能；</li>
</ul>
<h2 id="需要的工具"><a href="#需要的工具" class="headerlink" title="需要的工具"></a>需要的工具</h2><hr>
<ul>
<li>虚拟机（本例以ESXI为配置平台，如果有实体机并带有两个网卡的话也是可以的，此处不涉及到基于VLAN的单臂路由）</li>
<li>Debian9.x光盘镜像（由于计划分配的内存较少，此处使用32位镜像）</li>
<li>SSH工具（如果是Win10的话可能只需要一个CMD即可）</li>
<li>一个梯子</li>
</ul>
<h2 id="开始折腾"><a href="#开始折腾" class="headerlink" title="开始折腾"></a>开始折腾</h2><hr>
<h3 id="下载Debian镜像"><a href="#下载Debian镜像" class="headerlink" title="下载Debian镜像"></a>下载Debian镜像</h3><hr>
<p>虽然Debian10正式版已经发布了，考虑到源同步的问题，还是使用Debian9版本比较靠谱，并且考虑到分配的内存只有256M，我选用了32位系统镜像（<strong>相信今后大部分Linux发行版都将舍弃32位系统，不过现在对我的影响不大</strong>），当然如果你想用64位的系统也是可以的，内存稍微分配大点即可；由于在官网提供的是最新的版本，故我们要去别的地方下载。</p>
<p>Debian老版本下载网站请点击<a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/">这里</a>，一直向下滚就可以看到我们需要的Debian9.9。</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/01.png" class="" title="download debian 9 01">

<p>点击我框出的位置，然后点击i386（此处表示32位系统），如下图所示：</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/02.png" class="" title="download debian 9 02">

<p>选择iso-cd，安装是会自动下载一些安装包，如果网络不是很好的话也可以选择iso-dvd，dvd版本会集成大部分需要用到的组件；</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/03.png" class="" title="download debian 9 03">

<p>随后即可点击你所需要的镜像了，我选择了netinst版本，即在安装的过程中会自动下载组件包的版本；</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/04.png" class="" title="download debian 9 04">

<p>当然，如果你懒得自己去找下载地址，我也会提供相应的下载链接（方便大家一下吧！）：</p>
<h4 id="Debian9-9-0-下载链接"><a href="#Debian9-9-0-下载链接" class="headerlink" title="Debian9.9.0 下载链接"></a>Debian9.9.0 下载链接</h4><blockquote>
<p>如果通过多线程下载软件如<a target="_blank" rel="noopener" href="https://www.internetdownloadmanager.com/">IDM</a>依然速度不理想的话，建议还是通过<a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/BitTorrent_(%E5%8D%8F%E8%AE%AE)">BT</a>下载比较好</p>
</blockquote>
<table>
<thead>
<tr>
<th align="center">32 or 64</th>
<th align="center">下载地址</th>
</tr>
</thead>
<tbody><tr>
<td align="center">32</td>
<td align="center"><a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/i386/bt-cd/debian-9.9.0-i386-netinst.iso.torrent">bt-cd</a></td>
</tr>
<tr>
<td align="center">32</td>
<td align="center"><a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/i386/bt-dvd/debian-9.9.0-i386-DVD-1.iso.torrent">bt-dvd1</a>&#x2F;<a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/i386/bt-dvd/debian-9.9.0-i386-DVD-2.iso.torrent">bt-dvd2</a>&#x2F;<a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/i386/bt-dvd/debian-9.9.0-i386-DVD-3.iso.torrent">bt-dvd3</a></td>
</tr>
<tr>
<td align="center">32</td>
<td align="center"><a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/i386/iso-cd/debian-9.9.0-i386-netinst.iso">iso-cd</a></td>
</tr>
<tr>
<td align="center">32</td>
<td align="center"><a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/i386/iso-dvd/debian-9.9.0-i386-DVD-1.iso">iso-dvd1</a>&#x2F;<a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/i386/iso-dvd/debian-9.9.0-i386-DVD-2.iso">iso-dvd2</a>&#x2F;<a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/i386/iso-dvd/debian-9.9.0-i386-DVD-3.iso">iso-dvd3</a></td>
</tr>
<tr>
<td align="center">64</td>
<td align="center"><a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/amd64/bt-cd/debian-9.9.0-amd64-netinst.iso.torrent">bt-cd</a></td>
</tr>
<tr>
<td align="center">64</td>
<td align="center"><a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/amd64/bt-dvd/debian-9.9.0-amd64-DVD-1.iso.torrent">bt-dvd1</a>&#x2F;<a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/amd64/bt-dvd/debian-9.9.0-amd64-DVD-2.iso.torrent">bt-dvd2</a>&#x2F;<a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/amd64/bt-dvd/debian-9.9.0-amd64-DVD-3.iso.torrent">bt-dvd3</a></td>
</tr>
<tr>
<td align="center">64</td>
<td align="center"><a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/amd64/iso-cd/debian-9.9.0-amd64-netinst.iso">iso-cd</a></td>
</tr>
<tr>
<td align="center">64</td>
<td align="center"><a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/amd64/iso-dvd/debian-9.9.0-amd64-DVD-1.iso">iso-dvd1</a>&#x2F;<a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/amd64/iso-dvd/debian-9.9.0-amd64-DVD-2.iso">iso-dvd2</a>&#x2F;<a target="_blank" rel="noopener" href="http://cdimage.debian.org/cdimage/archive/9.9.0/amd64/iso-dvd/debian-9.9.0-amd64-DVD-3.iso">iso-dvd3</a></td>
</tr>
</tbody></table>
<h3 id="ESXI配置虚拟机"><a href="#ESXI配置虚拟机" class="headerlink" title="ESXI配置虚拟机"></a>ESXI配置虚拟机</h3><hr>
<blockquote>
<p>使用ESXI已经很多年了，相对而言配置更加得心应手，当然其他的虚拟化工具也是可以使用的，本次主要以ESXI为例，希望大家不要吐槽。</p>
</blockquote>
<p>那就开始吧！</p>
<h4 id="上传镜像"><a href="#上传镜像" class="headerlink" title="上传镜像"></a>上传镜像</h4><p>将下载好的镜像上传至ESXI的内部存储中，等会安装虚拟机需要用到的；</p>
<h4 id="配置网络"><a href="#配置网络" class="headerlink" title="配置网络"></a>配置网络</h4><p>家里原有的网络结构暂时不想改变，利用ESXI的虚拟网卡，这次我新建一个网络，在这个网络中进行调试，不影响我原有的网络结构；</p>
<p>网络结构及网段划分</p>
<h5 id="ROS—-172-16-1-0-x2F-24—-Linux-Router—-192-168-100-0-x2F-24—-Manjaro"><a href="#ROS—-172-16-1-0-x2F-24—-Linux-Router—-192-168-100-0-x2F-24—-Manjaro" class="headerlink" title="ROS—-172.16.1.0&#x2F;24—-Linux Router—-192.168.100.0&#x2F;24—-Manjaro"></a>ROS—-172.16.1.0&#x2F;24—-Linux Router—-192.168.100.0&#x2F;24—-Manjaro</h5><blockquote>
<p>家中的主路由是RouterOS，内网网段是172.16.1.0&#x2F;24，计划将这台Linux Router的WAN口配置为172.16.1.50&#x2F;24，LAN口配置为192.168.100.1&#x2F;24，连接在LAN的设备所处网段是192.168.100.0&#x2F;24，我将利用上次做演示的Manjaro做接入，到时候看看效果如何。</p>
</blockquote>
<p>配置网络也很简单，进入 <strong>配置—-网络—点击右上角的添加网络向导</strong> ，然后就可以添加新的网络了；</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/05.png" class="" title="configure network 01">

<ul>
<li>连接类型选择虚拟机</li>
</ul>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/06.png" class="" title="configure network 02">

<ul>
<li>创建vSphere标准交换机（此处我并没有选择物理网卡，我直接使用内部通讯虚拟出一个网络交换机）</li>
</ul>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/07.png" class="" title="configure network 03">

<ul>
<li>给新建的网络起个名字</li>
</ul>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/08.png" class="" title="configure network 04">

<ul>
<li>直接点击完成，之后就可以看到网络中新出现的标准交换机</li>
</ul>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/09.png" class="" title="configure network 05">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/10.png" class="" title="configure network 06">

<ul>
<li>随后点击新的标准交换机的属性，进行编辑，在安全选项卡中启用混杂模式，此时会提示没有物理网卡，不用管，直接确定</li>
</ul>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/11.png" class="" title="configure network 07">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/12.png" class="" title="configure network 08">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/13.png" class="" title="configure network 09">

<p>至此新的网络的配置就完成了。</p>
<h4 id="新建虚拟机"><a href="#新建虚拟机" class="headerlink" title="新建虚拟机"></a>新建虚拟机</h4><ul>
<li>新建虚拟机，由于我使用的是6.0版本，ESXI上没有Debian9的虚拟机类型，那就选择Debian8吧，问题不大</li>
</ul>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/14.png" class="" title="configure vm 01">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/15.png" class="" title="configure vm 02">

<ul>
<li>选择两个处理器，内存就用原计划的256M吧</li>
</ul>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/16.png" class="" title="configure vm 03">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/17.png" class="" title="configure vm 04">

<ul>
<li>网卡选择两块，VM Network对应172.16.1.0&#x2F;24网段，作为Linux Router的WAN口，Linux router对应192.168.100.0.24网段，作为LAN口，硬盘直接使用默认配置，16G足矣</li>
</ul>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/18.png" class="" title="configure vm 05">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/19.png" class="" title="configure vm 06">

<ul>
<li>以上结束之后记得勾选上完成前编辑虚拟机设置</li>
</ul>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/20.png" class="" title="configure vm 07">

<ul>
<li>在编辑界面需要修改两个位置，移除软盘，添加ISO镜像到虚拟光驱，并且勾选上打开电源是连接，如下图所示</li>
</ul>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/21.png" class="" title="configure vm 08">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/22.png" class="" title="configure vm 09">

<blockquote>
<p>至此虚拟机的前期配置就搞了，如果使用6.5或者6.7版本的ESXI，在网页上配置基本上也类似</p>
</blockquote>
<h4 id="安装虚拟机"><a href="#安装虚拟机" class="headerlink" title="安装虚拟机"></a>安装虚拟机</h4><p>在ESXI中安装虚拟机应该不难，Debian9的安装也很简单，大致上过去在Hyper-V上安装Ubuntu一样，为了节省时间，我就直接忽略这部分了（希望大家不要打我），只不过为了有效利用256M的内存，需要在组件选择的时候稍微调整一下，如下图所示：</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/25.png" class="" title="install vm">

<blockquote>
<p>需要取消掉桌面环境和打印服务组件，启用ssh服务，桌面的环境肯定会消耗不小的性能，而打印机我觉得作为二级路由暂时还用不到，用不到就不浪费空间来安装了，然后启用SSH的话就可以远程进行管理了</p>
</blockquote>
<h3 id="正式配置"><a href="#正式配置" class="headerlink" title="正式配置"></a>正式配置</h3><hr>
<h4 id="1-安装Open-vm-tool组件"><a href="#1-安装Open-vm-tool组件" class="headerlink" title="1.安装Open-vm-tool组件"></a>1.安装Open-vm-tool组件</h4><p>安装Open-vm-tool之后会比较方便的进行虚拟机开关机和重启，安装也很简单</p>
<p>首先需要点击控制台上的虚拟机选项——客户机—— <strong>安装&#x2F;升级VMware Tools</strong>，中间会跳出几个对话框，不用管，直接确定</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/26.png" class="" title="configure debian 01">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/27.png" class="" title="configure debian 02">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/28.png" class="" title="configure debian 03">

<p>之后在控制台中执行下述命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/cdrom /mnt #挂载光驱至mnt目录下</span><br><span class="line">cd /mnt &amp;&amp; cp VMwareTools-10.2.5-8068406.tar.gz /tmp #此处的VMwareTools的版本会随着ESXI版本的不同而不同，多使用Tab键补全命令</span><br><span class="line">cd /tmp</span><br><span class="line">tar xzf VMwareTools-10.2.5-8068406.tar.gz #将刚刚复制的压缩包解压</span><br><span class="line">cd vmware-tools-distrib/ #进入刚刚解压出来的压缩包目录</span><br><span class="line">ls</span><br></pre></td></tr></table></figure>

<p>此处即可看到安装组件的脚本</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/29.png" class="" title="configure debian 04">

<p>直接执行 <code>./vmware-install.pl</code> 即可，此处会进入交互安装模式，除了第一个需要回答之外，其它的基本上一路回车即可，此处直接输入y并回车</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/30.png" class="" title="configure debian 05">

<p>安装完成之后就可以在ESXI的摘要界面上看到虚拟机此时使用的IP地址了，出现这个就说明安装成功并正常运行了</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/31.png" class="" title="configure debian 06">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/32.png" class="" title="configure debian 07">

<h4 id="2-安装基础软件及配置环境"><a href="#2-安装基础软件及配置环境" class="headerlink" title="2.安装基础软件及配置环境"></a>2.安装基础软件及配置环境</h4><blockquote>
<p>此处安装的软件并不是必须的，但可以提升Linux的操作便利性（<strong>只用命令行还谈什么便利性</strong>），我一般会执行这样的命令</p>
</blockquote>
<p><code>apt-get install vim htop lrzsz git mlocate tmux -y</code></p>
<p>当然，由于使用了中文语言环境，在控制台上显示的中文都是方块，还是用SSH配置比较好</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/34.png" class="" title="configure debian 08">

<p>之后再调整一下快捷命令，执行如下命令 <code>vi ~/.bashrc</code> ，此处的 <strong>~</strong> 表示的是用户家目录，类似于Windows上Administrator目录，里面存放着用户的个人文件和配置， <strong>.</strong> 表示隐藏的文件</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/36.png" class="" title="configure debian 09">

<p>将上述的内容修改成如下所示</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/37.png" class="" title="configure debian 10">

<p>这些内容主要是让文件进行彩色显示，同时设置一些快捷命令，比如“ll”就相当于执行了“ls -l”，有兴趣的可以对比一下这些命令的差异，保存并退出之后，执行 <code>source ~/.bashrc</code> 即可应用上面的那些修改</p>
<h4 id="3-修改SSH用密码登录"><a href="#3-修改SSH用密码登录" class="headerlink" title="3.修改SSH用密码登录"></a>3.修改SSH用密码登录</h4><p>如果要使用SSH登陆的话需要修改一下SSH的配置文件，此处执行 <code>vi /etc/ssh/sshd.config</code> ，找到这个位置</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/38.png" class="" title="configure debian 11">

<p>修改成如下内容即可</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/39.png" class="" title="configure debian 12">

<p>之后执行 <code>systemctl restart sshd</code> 重启一下服务就可以应用修改了</p>
<h4 id="4-配置网卡地址"><a href="#4-配置网卡地址" class="headerlink" title="4.配置网卡地址"></a>4.配置网卡地址</h4><p>按照原定的计划，虚拟机的两张网卡分别配置成WAN口和LAN口，此处执行 <code>ip a</code> 查看网卡名，<strong>ens192</strong> 将作为WAN口， <strong>ens224</strong> 作为LAN口</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/40.png" class="" title="configure debian 13">

<p>网卡的配置文件是“&#x2F;etc&#x2F;network&#x2F;interface”,直接执行 <code>vi /etc/network/interface</code> 进行编辑，下面的是我的配置，除了IP，网关等信息外，我还使用 <strong>auto</strong> 替换了 <strong>allow-hotplug</strong> ，确保在系统启动时候无论网卡处在何种状态都启用网卡</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/55.png" class="" title="configure debian 14">

<p>直接执行 <code>systemctl restart networking</code> ，然后通过 <code>ip a</code> 查看网卡情况，配置的网卡信息就已经生效了</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/42.png" class="" title="configure debian 15">

<p>之后就可以通过SSH工具进行连接了，此处我选择了<a target="_blank" rel="noopener" href="https://www.netsarang.com/zh/xshell/">Xshell</a>,使用个人和学生版即可，商业版是需要收费的</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/43.png" class="" title="configure debian 16">

<h4 id="5-开启转发并配置iptables"><a href="#5-开启转发并配置iptables" class="headerlink" title="5.开启转发并配置iptables"></a>5.开启转发并配置iptables</h4><blockquote>
<p>Linux如果要成为一台路由器，必须先开启转发的功能</p>
</blockquote>
<p> <code>vi /etc/sysctl.conf</code>对 <strong>sysctl.conf</strong> 文件进行编辑，定位到如下位置</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/46.png" class="" title="configure debian 17">

<p>删除此行前面的 <strong>#</strong> 符号，然后保存，执行 <code>sysctl -p</code> 即可生效，并且重启也不会受到影响</p>
<hr>
<p>接下来就是重头戏了，iptables命令，此处就不深入进行讲解了，如果大家有兴趣我会更新一下这方面的知识</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重置iptables配置</span></span><br><span class="line">iptables -F</span><br><span class="line">iptables -X</span><br><span class="line">iptables -t nat -F</span><br><span class="line">iptables -t nat -X</span><br><span class="line">iptables -t mangle -F</span><br><span class="line">iptables -t mangle -X</span><br><span class="line">iptables -t raw -F</span><br><span class="line">iptables -t raw -X</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">转发两块网卡之间的数据</span></span><br><span class="line">iptables -A FORWARD -i ens224 -s 192.168.100.0/24 -j ACCEPT</span><br><span class="line">iptables -A FORWARD -i ens192 -d 192.168.100.0/24 -j ACCEPT</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">源地址伪装，将所有内网的地址全部伪装成WAN口的地址，所有数据包都修改了来源的地址，这里是172.16.1.50/24</span></span><br><span class="line">iptables -t nat -A POSTROUTING -o ens192 -j MASQUERADE</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">开启必要的端口和策略，此处开启WAN口的SSH端口</span></span><br><span class="line">iptables -I INPUT 1 -i lo -j ACCEPT</span><br><span class="line">iptables -I INPUT 1 -i ens224 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp --dport 22 -i ens192 -j ACCEPT</span><br><span class="line">iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置默认的防火墙规则，防火墙一般都是以先允许后阻止这样的原则进行配置的，并且防火墙的规则是从上而下依次进行匹配的，需要开放的规则必须要放在阻止的规则上面，此处就是最后的阻止部分</span></span><br><span class="line">iptables -P INPUT DROP</span><br><span class="line">iptables -P OUTPUT ACCEPT</span><br><span class="line">iptables -P FORWARD DROP</span><br></pre></td></tr></table></figure>

<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/47.png" class="" title="configure debian 18">

<p>配置完上述命令之后，路由功能基本上就实现了</p>
<h4 id="6-实测"><a href="#6-实测" class="headerlink" title="6.实测"></a>6.实测</h4><p>口说无凭，还是拿出点证据来吧！我这次就用上次演示的Manjaro虚拟机吧，修改网络连接，使用最新建立的那个网卡</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/48.png" class="" title="configure debian 19">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/49.png" class="" title="configure debian 20">

<p>同时修改一下虚拟机的网卡地址，此次我只是配置了路由，DHCP和DNS功能并没有配置，所以需要手动指定，将网络设置为192.168.100.10，和 <strong>ens224</strong> 网卡同一个网段，网关直接指向 <strong>ens224</strong> 的地址，DNS就是用最常用的114.114.114.114吧</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/50.png" class="" title="configure debian 21">

<p>先ping一下看看通不通</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/51.png" class="" title="configure debian 22">

<p>就用<a target="_blank" rel="noopener" href="https://www.bilibili.com/">B站</a>验证一下吧</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/52.png" class="" title="configure debian 23">
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/53.png" class="" title="configure debian 24">

<p>右侧显示的是 <strong>ens224</strong> 的流量信息，看1080P的视频一点问题都没有（原谅我Manjaro的性能有点差，4K是跑不动了）</p>
<h4 id="7-iptables规则固化"><a href="#7-iptables规则固化" class="headerlink" title="7.iptables规则固化"></a>7.iptables规则固化</h4><p>Debian的iptables不会开机启动，如果不进行一些操作的话，一重启一开始配置的iptables规则就会失效，路由功能就废了，为了解决这个问题，需要在开机的时候就加载iptables规则</p>
<p>执行<code>cd /etc/network</code>打开network目录，此时在这个目录下有如下几个文件</p>
<img src="/2019/07/20/linux-router-02-install-debian-and-configure-forward/54.png" class="" title="configure debian 22">

<p>每个文件对应的功能如下：</p>
<table>
<thead>
<tr>
<th align="center">文件名</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">if-down.d</td>
<td align="center">网卡关闭时执行动作</td>
</tr>
<tr>
<td align="center">if-post-down.d</td>
<td align="center">网卡关闭后执行动作</td>
</tr>
<tr>
<td align="center">if-pre-up.d</td>
<td align="center">网卡启动前执行动作</td>
</tr>
<tr>
<td align="center">if-up.d</td>
<td align="center">网卡启动时执行动作</td>
</tr>
<tr>
<td align="center">interface</td>
<td align="center">网卡配置信息</td>
</tr>
<tr>
<td align="center">interface.d</td>
<td align="center">网卡扩展配置</td>
</tr>
</tbody></table>
<p>此处需要用到两个目录，<strong>if-pre-up.d</strong> 和 <strong>if-post-down.d</strong>  ，我需要写两个脚本，分别在网卡开启前导入iptables规则和在网卡关闭后自动保存iptables规则，看似功能很“高级”，但实际上实现非常简单</p>
<p>在<strong>if-post-down.d</strong>目录中新建一个文件，<code>vi /etc/network/if-post-down.d/iptables</code>，然后输入如下内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">/sbin/iptables-save &gt; /etc/iptables/rule.v4 #将iptables规则保存至/etc/iptables目录下的rule.v4文件中</span><br></pre></td></tr></table></figure>

<p>同样的在<strong>if-pre-up.d</strong>目录中新建一个文件，<code>vi /etc/network/if-pre-up.d/iptables</code>并输入如下内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">/sbin/iptables-restore &lt; /etc/iptables/rule.v4 #将/etc/iptables/rule.v4中的iptables配置导入系统</span><br></pre></td></tr></table></figure>

<p>以上的操作即可在系统重启时自动保存iptables规则，并开机加载</p>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><hr>
<ul>
<li><strong>2019.07.21</strong> 下载镜像及配置虚拟机网络</li>
<li><strong>2019.07.26</strong> 完成主体内容</li>
<li><strong>2019.07.28</strong> 增加重启后加载iptables的方法</li>
<li><strong>2019.07.29</strong> 修正部分错误</li>
<li><strong>2019.08.11</strong> 嵌入视频说明</li>
<li><strong>2019.09.10</strong> 格式调整</li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Linux/" rel="tag"># Linux</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2019/07/18/linux-router-01-nat-and-firewall/" rel="prev" title="Linux路由补完计划01 基本概念说明">
      <i class="fa fa-chevron-left"></i> Linux路由补完计划01 基本概念说明
    </a></div>
      <div class="post-nav-item">
    <a href="/2019/07/26/linux-router-03-DNS-and-DHCP/" rel="next" title="Linux路由补完计划03 配置DNS和DHCP">
      Linux路由补完计划03 配置DNS和DHCP <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    
  <div class="comments">
    <div id="lv-container" data-id="city" data-uid="MTAyMC80NTQzMy8yMTk0NQ"></div>
  </div>
  

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%86%E9%A2%91%E8%AF%B4%E6%98%8E"><span class="nav-number">2.</span> <span class="nav-text">视频说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%9F%E8%83%BD%E8%AF%B4%E6%98%8E"><span class="nav-number">3.</span> <span class="nav-text">功能说明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%9C%80%E8%A6%81%E7%9A%84%E5%B7%A5%E5%85%B7"><span class="nav-number">4.</span> <span class="nav-text">需要的工具</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BC%80%E5%A7%8B%E6%8A%98%E8%85%BE"><span class="nav-number">5.</span> <span class="nav-text">开始折腾</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BDDebian%E9%95%9C%E5%83%8F"><span class="nav-number">5.1.</span> <span class="nav-text">下载Debian镜像</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Debian9-9-0-%E4%B8%8B%E8%BD%BD%E9%93%BE%E6%8E%A5"><span class="nav-number">5.1.1.</span> <span class="nav-text">Debian9.9.0 下载链接</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ESXI%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="nav-number">5.2.</span> <span class="nav-text">ESXI配置虚拟机</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8A%E4%BC%A0%E9%95%9C%E5%83%8F"><span class="nav-number">5.2.1.</span> <span class="nav-text">上传镜像</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE%E7%BD%91%E7%BB%9C"><span class="nav-number">5.2.2.</span> <span class="nav-text">配置网络</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ROS%E2%80%94-172-16-1-0-x2F-24%E2%80%94-Linux-Router%E2%80%94-192-168-100-0-x2F-24%E2%80%94-Manjaro"><span class="nav-number">5.2.2.1.</span> <span class="nav-text">ROS—-172.16.1.0&#x2F;24—-Linux Router—-192.168.100.0&#x2F;24—-Manjaro</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%B0%E5%BB%BA%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="nav-number">5.2.3.</span> <span class="nav-text">新建虚拟机</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E8%A3%85%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="nav-number">5.2.4.</span> <span class="nav-text">安装虚拟机</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A3%E5%BC%8F%E9%85%8D%E7%BD%AE"><span class="nav-number">5.3.</span> <span class="nav-text">正式配置</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%AE%89%E8%A3%85Open-vm-tool%E7%BB%84%E4%BB%B6"><span class="nav-number">5.3.1.</span> <span class="nav-text">1.安装Open-vm-tool组件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%AE%89%E8%A3%85%E5%9F%BA%E7%A1%80%E8%BD%AF%E4%BB%B6%E5%8F%8A%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83"><span class="nav-number">5.3.2.</span> <span class="nav-text">2.安装基础软件及配置环境</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E4%BF%AE%E6%94%B9SSH%E7%94%A8%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95"><span class="nav-number">5.3.3.</span> <span class="nav-text">3.修改SSH用密码登录</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E9%85%8D%E7%BD%AE%E7%BD%91%E5%8D%A1%E5%9C%B0%E5%9D%80"><span class="nav-number">5.3.4.</span> <span class="nav-text">4.配置网卡地址</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-%E5%BC%80%E5%90%AF%E8%BD%AC%E5%8F%91%E5%B9%B6%E9%85%8D%E7%BD%AEiptables"><span class="nav-number">5.3.5.</span> <span class="nav-text">5.开启转发并配置iptables</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-%E5%AE%9E%E6%B5%8B"><span class="nav-number">5.3.6.</span> <span class="nav-text">6.实测</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#7-iptables%E8%A7%84%E5%88%99%E5%9B%BA%E5%8C%96"><span class="nav-number">5.3.7.</span> <span class="nav-text">7.iptables规则固化</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E5%8E%86%E5%8F%B2"><span class="nav-number">6.</span> <span class="nav-text">更新历史</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">ksana410</p>
  <div class="site-description" itemprop="description">热爱瞎折腾的理工男</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">14</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ksana410" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;ksana410" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ddxiong0410@gmail.com" title="E-Mail → mailto:ddxiong0410@gmail.com" rel="noopener" target="_blank"><i class="envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.youtube.com/channel/UCuD7wIVAKLcB6iDbdsKxFxw" title="YouTube → https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCuD7wIVAKLcB6iDbdsKxFxw" rel="noopener" target="_blank"><i class="youtube fa-fw"></i>YouTube</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ksana410</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script>
NexT.utils.loadComments(document.querySelector('#lv-container'), () => {
  window.livereOptions = {
    refer: location.pathname.replace(CONFIG.root, '').replace('index.html', '')
  };
  (function(d, s) {
    var j, e = d.getElementsByTagName(s)[0];
    if (typeof LivereTower === 'function') { return; }
    j = d.createElement(s);
    j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
    j.async = true;
    e.parentNode.insertBefore(j, e);
  })(document, 'script');
});
</script>

</body>
</html>
